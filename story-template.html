<!doctype html>
<!--
	Author by FreeHTML5.co
	Twitter: https://twitter.com/fh5co
	Facebook: https://fb.com/fh5co
	URL: https://freehtml5.co
-->
<html lang="en">
<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/slick.css">
	<title>Jacob Sinisi</title>
</head>
<body>

	<!-- Navigation -->
	<nav class="site-navigation">
		<div class="site-navigation-inner site-container">
			<!-- <img src="./images/author_logo.png" alt="site logo" style="max-width: 100px; max-height: 50px;"> -->
			<div class="main-navigation">
				<ul class="main-navigation__ul">
					<li><a href="index.html">Homepage</a></li>
					<!-- <li><a href="#">Books</a></li> -->
					<li><a href="short-stories.html">Short Stories</a></li>
				</ul>
			</div>
			<div id="myBtn" class="burger-container" onclick="myFunction(this)">
				<div class="bar1"></div>
				<div class="bar2"></div>
				<div class="bar3"></div>
			</div>
			<script>
				function myFunction(x) {
					x.classList.toggle("change");
				}
			</script>

		</div>
	</nav>
	<!-- Navigation end -->

    <section class="story-content">
        <div class="site-container">
            <h1 id="story-title"></h1>
            <div id="story-text"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="site-container" style="display: none">
            <div class="footer-inner">
                <div class="footer-info">
                    <div class="footer-info__left">
                        <img src="./images/footer-img.jpg" alt="about me image">
                        <p>Read more about me</p>
                    </div>
                    <div class="footer-info__right" style="display: none">
                        <h5>Get In Touch</h5>
                        <!-- <p class="footer-phone">Phone: +958734902847</p>
                        <p>Email : Jacob@Example.com</p> -->
                        <div class="social-icons">
                            <a href="#" target="_blank"><img src="./images/social-twitter.png" alt="social icon"></a>
                            <a href="#" target="_blank"><img src="./images/social-pinterest.png" alt="social icon"></a>
                            <a href="#" target="_blank"><img src="./images/social-youtube.png" alt="social icon"></a>
                            <a href="#" target="_blank"><img src="./images/social-twitter.png" alt="social icon"></a>
                        </div>
                    </div>
                </div>
                <div class="footer-contact-form">
                    <h5>Contact Form</h5>
                    <form class="contact-form">
                        <div class="contact-form__input">
                            <input type="text" name="name" placeholder="Name">
                            <input type="email" name="email" placeholder="Email">
                        </div>
                        <textarea></textarea>
                        <input type="submit" name="submit" value="Submit" class="submit-button">
                    </form>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="site-container footer-bottom-inner">
                <p>Â© 2024 Jacob Sinisi | Based on a design by <a href="https://freehtml5.co/" target="_blank">freehtml5.co</a> | All rights Reserved.</p>
            </div>
        </div>
    </footer>
    <!-- Footer end -->

    <!-- Scripts -->
    <script src="js/jquery.min.js"></script>
    <script src="js/slick.min.js"></script>
    <script src="js/main.js"></script>

    <script>
        $(document).ready(function() {
            const urlParams = new URLSearchParams(window.location.search);
            const storyFile = urlParams.get('story');
            const fileType = urlParams.get('type') || 'txt'; // Default to txt if no type specified

            console.log('Story file:', storyFile, 'Type:', fileType); // Debugging line
            
            if (storyFile) {
                const fileExtension = fileType === 'html' ? '.html' : '.txt';
                const filePath = `stories/${storyFile}${fileExtension}`;
                
                $.get(filePath)
                    .done(function(data) {
                        console.log('Story data loaded successfully'); // Debugging line
                        
                        if (fileType === 'html') {
                            // For HTML files, parse the content and preserve HTML structure
                            const tempDiv = $('<div>').html(data);
                            const title = tempDiv.find('h1, .title').first().text() || 
                                         tempDiv.find('title').text() || 
                                         storyFile.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                            
                            $('#story-title').text(title);
                            
                            // Remove the title from content and set the HTML
                            tempDiv.find('h1, .title, title').first().remove();
                            $('#story-text').html(tempDiv.html());
                            
                            // Add a class to indicate HTML content for styling
                            $('#story-text').addClass('html-content');
                        } else {
                            // For text files, handle as before but with better title extraction
                            const storyParts = data.split('\n');
                            const title = storyParts[0].trim() || 
                                         storyFile.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                            
                            $('#story-title').text(title);
                            $('#story-text').text(storyParts.slice(1).join('\n'));
                            
                            // Add a class to indicate text content for styling
                            $('#story-text').addClass('text-content');
                        }
                    })
                    .fail(function() {
                        console.log('Failed to load story, trying alternate file type');
                        // If the requested file type fails, try the other type
                        const alternateExtension = fileType === 'html' ? '.txt' : '.html';
                        const alternatePath = `stories/${storyFile}${alternateExtension}`;
                        
                        $.get(alternatePath)
                            .done(function(data) {
                                const isAlternateHtml = alternateExtension === '.html';
                                
                                if (isAlternateHtml) {
                                    const tempDiv = $('<div>').html(data);
                                    const title = tempDiv.find('h1, .title').first().text() || 
                                                 storyFile.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                                    $('#story-title').text(title);
                                    tempDiv.find('h1, .title, title').first().remove();
                                    $('#story-text').html(tempDiv.html()).addClass('html-content');
                                } else {
                                    const storyParts = data.split('\n');
                                    const title = storyParts[0].trim() || 
                                                 storyFile.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                                    $('#story-title').text(title);
                                    $('#story-text').text(storyParts.slice(1).join('\n')).addClass('text-content');
                                }
                            })
                            .fail(function() {
                                $('#story-title').text('Story Not Found');
                                $('#story-text').text('The requested story could not be found.');
                            });
                    });
            } else {
                $('#story-title').text('No Story Selected');
                $('#story-text').text('No story was specified.');
            }
        });
    </script>
    <!-- Scripts end -->
</body>
</html>